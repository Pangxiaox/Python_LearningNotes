# PythonçŸ¥è¯†å­¦ä¹ 

**æ³¨ï¼šæœ¬ç¬”è®°ç‰ˆæœ¬ä¸ºPython3**



### 1. Pythonç®€ä»‹

Pythonæ˜¯ä¸€ä¸ªé«˜å±‚æ¬¡çš„ç»“åˆäº†è§£é‡Šæ€§ã€ç¼–è¯‘æ€§ã€äº’åŠ¨æ€§å’Œé¢å‘å¯¹è±¡çš„è„šæœ¬è¯­è¨€

è§£é‡Šæ€§ï¼šå¼€å‘è¿‡ç¨‹ä¸­æ²¡æœ‰ç¼–è¯‘è¿™ç¯èŠ‚

äº¤äº’å¼ï¼šåœ¨ä¸€ä¸ªPythonæç¤ºç¬¦>>>åç›´æ¥æ‰§è¡Œä»£ç 



### 2. æ¡ä»¶è¯­å¥

- ifè¯­å¥å—å…³é”®å­—ä¸ºï¼šif-elif-else

```python
a = int(input("è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š"))


if a == 0:
    print("0")


elif a > 0:
    print("æ­£æ•´æ•°")

else:
    print("è´Ÿæ•´æ•°")
```

ğŸ”º 1. æ¯ä¸ªæ¡ä»¶åé¢ç”¨å†’å·ï¼šï¼Œè¡¨ç¤ºæ¥ä¸‹æ¥æ˜¯æ»¡è¶³æ¡ä»¶åè¦æ‰§è¡Œçš„è¯­å¥å—

2. ç”¨ç¼©è¿›åˆ’åˆ†è¯­å¥å—ï¼Œç›¸åŒç¼©è¿›æ•°çš„è¯­å¥ç»„æˆä¸€ä¸ªè¯­å¥å—

3. æ²¡æœ‰switch-caseè¯­å¥

- ifåµŒå¥—

```python
a = float(input("è¾“å…¥ä¸€ä¸ªæ•°"))
if a < 7:
    if a < 4:
        print(a, "å°äº4")
    else:
        print(a, "å¤§äºç­‰äº4ä¸”å°äº7")
elif a == 7:
    print(a, "ç­‰äº7")
else:
    print(a, "å¤§äº7")
```



### 3. å¾ªç¯è¯­å¥

- whileè¯­å¥

```python
n = int(input("è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•°"))
sum = 0
a = 1
while a <= n:
    sum += a
    a += 1
print("1åˆ°%dçš„æ€»å’Œä¸º:%d" % (n, sum))
```

ğŸ”ºæ³¨æ„å†’å·å’Œç¼©è¿›ï¼Œæ²¡æœ‰do...whileå¾ªç¯

- whileå¾ªç¯ä½¿ç”¨elseè¯­å¥ï¼šæ¡ä»¶è¯­å¥ä¸ºfalseæ—¶å€™æ‰§è¡Œelseè¯­å¥å—

```python
a = 3
while a < 6:
    print(a)
    a += 1
else:
    print("oops:%d" % a)
```

- forè¯­å¥

```python
list = ['1', '2', 'a', 'b']
for item in list:
    print(item)
```

- forè¯­å¥+range()å‡½æ•°

ä¾‹å­1ï¼šéå†æ•°å­—åºåˆ—

```python
for i in range(3):
    print(i) # è¾“å‡º 0 1 2ï¼ˆæœ‰æ¢è¡Œï¼‰
```

ä¾‹å­2ï¼šæŒ‡å®šåŒºé—´å€¼

```python
for i in range(3, 6):
    print(i) # è¾“å‡º 3 4 5ï¼ˆæœ‰æ¢è¡Œï¼‰
```

ä¾‹å­3ï¼šæŒ‡å®šæ•°å­—åŒºé—´å¹¶æŒ‡å®šä¸åŒå¢é‡ï¼ˆæ­¥é•¿ï¼‰ï¼Œæ­¥é•¿ä¸ºè´Ÿæ•°ä¹Ÿå¯ä»¥

```python
for i in range(20, 14, -2):
    print(i) # è¾“å‡º 20 18 16ï¼ˆæœ‰æ¢è¡Œï¼‰
```

- breakè¯­å¥

```python
n = 5
while n > 0:
    n -= 1
    if n == 2:
        break
    print(n)
print('å¾ªç¯ç»“æŸã€‚')
```

- continueè¯­å¥

```python
n = 5
while n > 0:
    n -= 1
    if n == 2:
        continue
    print(n)
print('å¾ªç¯ç»“æŸã€‚')
```

ğŸ”ºå¾ªç¯è¯­å¥å¯ä»¥æœ‰elseå­å¥ï¼Œåœ¨ç©·å°½åˆ—è¡¨ï¼ˆforå¾ªç¯ï¼‰æˆ–æ¡ä»¶å˜ä¸ºfalseï¼ˆwhileå¾ªç¯ï¼‰å¯¼è‡´å¾ªç¯ç»ˆæ­¢æ—¶è¢«æ‰§è¡Œï¼Œä½†å¾ªç¯è¢«breakç»ˆæ­¢æ—¶ä¸æ‰§è¡Œã€‚

```python
#  æŸ¥è¯¢è´¨æ•°
for n in range(2, 10):
    for x in range(2, n):
        if n % x == 0:
            print(n, 'ç­‰äº', x, '*', n//x)
            break
    else:
        # å¾ªç¯ä¸­æ²¡æœ‰æ‰¾åˆ°å…ƒç´ 
        print(n, ' æ˜¯è´¨æ•°')
```

- passè¯­å¥

passä¸€èˆ¬ç”¨ä½œå ä½è¯­å¥ï¼Œä¸åšä»»ä½•äº‹æƒ…

â­whileå¾ªç¯è¯­å¥å’Œforå¾ªç¯è¯­å¥ä½¿ç”¨elseçš„åŒºåˆ«ï¼š

elseå’Œwhileå¾ªç¯ä¸€èµ·ç”¨ï¼Œå½“æ¡ä»¶å˜ä¸ºFalseæ—¶æ‰§è¡Œelseè¯­å¥

elseå’Œforå¾ªç¯ä¸€èµ·ç”¨ï¼Œelseè¯­å¥å—åªåœ¨forå¾ªç¯æ­£å¸¸ç»ˆæ­¢æ—¶æ‰§è¡Œ



### 4. Pythonè¿ç®—ç¬¦

##### 4.1 ç®—æœ¯è¿ç®—ç¬¦

/ï¼šé™¤ï¼Œxé™¤ä»¥yï¼ˆa=21 b=10 a/bç»“æœä¸º2.1ï¼‰

//ï¼šå–æ•´é™¤ï¼Œå‘ä¸‹å–æ¥è¿‘é™¤æ•°çš„æ•´æ•°ï¼ˆ9//2ç­‰äº4ï¼Œ-9//2ç­‰äº-5ï¼‰

##### 4.2 æ¯”è¾ƒè¿ç®—ç¬¦

**4.3 èµ‹å€¼è¿ç®—ç¬¦**

**= ï¼šå¹‚èµ‹å€¼è¿ç®—ç¬¦

//= ï¼šå–æ•´é™¤èµ‹å€¼è¿ç®—ç¬¦

:=   ï¼šæµ·è±¡è¿ç®—ç¬¦ï¼Œå¯åœ¨è¡¨è¾¾å¼å†…éƒ¨ä¸ºå˜é‡èµ‹å€¼ã€‚Python 3.8ç‰ˆæœ¬æ–°å¢ã€‚

**4.4 ä½è¿ç®—ç¬¦**

&ã€|ã€^ï¼ˆæŒ‰ä½å¼‚æˆ–ï¼‰ã€~ï¼ˆæŒ‰ä½å–åï¼‰

<<ï¼šå·¦ç§»è¿ç®—ç¬¦ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0

ï¼ï¼ï¼šå³ç§»è¿ç®—ç¬¦ï¼Œä½ä½ä¸¢å¼ƒï¼Œé«˜ä½è¡¥0

**4.5 é€»è¾‘è¿ç®—ç¬¦**

andï¼šå¸ƒå°” ä¸ã€orï¼šå¸ƒå°” æˆ–ã€notï¼šå¸ƒå°” é

**4.6 æˆå‘˜è¿ç®—ç¬¦**

inã€not inï¼šæ˜¯å¦åœ¨åºåˆ—ä¸­ï¼ˆå­—ç¬¦ä¸²/åˆ—è¡¨/å…ƒç»„ï¼‰

**4.7 èº«ä»½è¿ç®—ç¬¦**

isã€is notï¼šåˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯å¦å¼•ç”¨è‡ªä¸€ä¸ªå¯¹è±¡

ğŸ”ºid()å‡½æ•°ç”¨äºè·å–å¯¹è±¡å†…å­˜åœ°å€

â­isä¸==åŒºåˆ«ï¼šisåˆ¤æ–­ä¸¤ä¸ªå˜é‡å¼•ç”¨å¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ä¸ªï¼Œ==åˆ¤æ–­å¼•ç”¨å˜é‡çš„å€¼æ˜¯å¦ç›¸ç­‰

**è¿ç®—ç¬¦ä¼˜å…ˆçº§**

ä»é«˜åˆ°ä½ï¼š

| è¿ç®—ç¬¦                   | æè¿°                               |
| ------------------------ | ---------------------------------- |
| **                       | æŒ‡æ•°                               |
| ~ + -                    | æŒ‰ä½ç¿»è½¬ï¼Œä¸€å…ƒåŠ å·å’Œå‡å·ï¼ˆ+@ã€-@ï¼‰ |
| * / % //                 | ä¹˜é™¤ï¼Œå–æ¨¡ï¼Œå–æ•´é™¤                 |
| + -                      | åŠ å‡                               |
| ï¼>   <<                 | å³ç§»ã€å·¦ç§»è¿ç®—                     |
| &                        | ä½è¿ç®—AND                          |
| ^ \|                     | ä½è¿ç®—ç¬¦                           |
| <= < > >=                | æ¯”è¾ƒè¿ç®—ç¬¦                         |
| <> == !=                 | ç­‰äºè¿ç®—ç¬¦                         |
| = %= /= //= -= += *= **= | èµ‹å€¼è¿ç®—ç¬¦                         |
| is is not                | èº«ä»½è¿ç®—ç¬¦                         |
| in not in                | æˆå‘˜è¿ç®—ç¬¦                         |
| not and orï¼ˆandé«˜äºorï¼‰  | é€»è¾‘è¿ç®—ç¬¦                         |



### 5. Python æ•°å­—ï¼ˆNumberï¼‰

Pythonæ•°å­—ç±»å‹ç”¨äºå­˜å‚¨æ•°å€¼ã€‚æ•°æ®ç±»å‹ä¸å…è®¸æ”¹å˜ï¼Œå¦‚æœæ”¹å˜æ•°å­—æ•°æ®ç±»å‹çš„å€¼ï¼Œå°†é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚

```python
var1 = 0x12
var2 = 0o12
var3 = complex(1, 2)
var4 = complex(5)
var5 = int(2.35)
var6 = float(5)
print(var1) # 18
print(var2)	# 10
print(var3) # (1+2j)
print(var4)	# (5+0j)
print(var5)	# 2
print(var6)	# 5.0
del var1, var2, var3, var4
print(8/3) # 2.6666666666666665ï¼ˆæ€»æ˜¯è¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°ï¼‰
print(8//3)	# 2
print(8.0//3) # 2.0
print(8//3.0) # 2.0
```

ğŸ”ºdelè¯­å¥åˆ é™¤æ•°å­—å¯¹è±¡çš„å¼•ç”¨

Pythonæ”¯æŒä¸‰ç§ä¸åŒçš„æ•°å€¼ç±»å‹ï¼šæ•´å‹ï¼ˆIntï¼‰ã€æµ®ç‚¹å‹ï¼ˆfloatï¼‰ã€å¤æ•°ï¼ˆcomplexï¼‰ï¼šå¤æ•°çš„å®éƒ¨å’Œè™šéƒ¨éƒ½æ˜¯æµ®ç‚¹å‹

**å¸¸ç”¨æ•°å­¦å‡½æ•°**

abs()ï¼šè¿”å›æ•°å­—ç»å¯¹å€¼ã€pow(x,y)ï¼šx**yè¿ç®—åçš„å€¼

**å¸¸ç”¨éšæœºæ•°å‡½æ•°**

choice(seq)ï¼šä»åºåˆ—çš„å…ƒç´ ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªå…ƒç´ 

random()ï¼›éšæœºç”Ÿæˆä¸‹ä¸€ä¸ªå®æ•°ï¼Œå®ƒåœ¨[0,1)èŒƒå›´å†…

random.randint(x,y)ï¼šéšæœºç”Ÿæˆä¸€ä¸ªintç±»å‹æ•´æ•°ï¼ŒæŒ‡å®šèŒƒå›´

**æ•°å­¦å¸¸é‡**

piï¼šåœ†å‘¨ç‡ã€eï¼šè‡ªç„¶å¸¸æ•°



### 6. Python æ³¨é‡Š

- å•è¡Œæ³¨é‡Šï¼šä»¥#å¼€å¤´
- å¤šè¡Œæ³¨é‡Šï¼šç”¨ä¸‰ä¸ªå•å¼•å·'''æˆ–ä¸‰ä¸ªåŒå¼•å·â€œâ€â€œå°†æ³¨é‡Šæ‹¬èµ·æ¥

```python
#  æ‰“å°å‡ºæ³¨é‡Šå†…å®¹
def a():
    '''
    æ³¨é‡Š
    æ–‡æœ¬1
    '''
print(a.__doc__)
```



### 7. Pythonå­—ç¬¦ä¸²

```python
a = 'abc'
b = "abcdefg"
print(a+b)	# abcabcdefg
print(a*3)	# abcabcabc	
print(b[1:4])	# bcd
print(a[1])	# b
if 'b' in a:
    print("yes")	# yes
if 'h' not in b:
    print("yes")	# yes
print(r'\n')	# \n
print(R'\n')	# \n
print("æˆ‘å« %s ï¼Œå¹´é¾„ä¸º %d" % ('ming', 24)) # æˆ‘å« mingï¼Œå¹´é¾„ä¸º 24
```

ç”¨å•å¼•å· ' æˆ–åŒå¼•å· â€œ åˆ›å»ºå­—ç¬¦ä¸²

Pythonä¸æ”¯æŒå•å­—ç¬¦ç±»å‹ï¼Œå•å­—ç¬¦ä¹Ÿæ˜¯ä½œä¸ºå­—ç¬¦ä¸²ä½¿ç”¨

**Python ä¸‰å¼•å·**

ä¸‰å¼•å·å…è®¸ä¸€ä¸ªå­—ç¬¦ä¸²è·¨å¤šè¡Œï¼Œå­—ç¬¦ä¸²ä¸­å¯åŒ…å«æ¢è¡Œç¬¦ã€åˆ¶è¡¨ç¬¦åŠå…¶ä»–ç‰¹æ®Šå­—ç¬¦

**f-string**

å­—é¢é‡æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²ä»¥få¼€å¤´ï¼Œåé¢è·Ÿç€å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­è¡¨è¾¾å¼ç”¨å¤§æ‹¬å·åŒ…èµ·æ¥ï¼Œä¼šå°†å˜é‡åŠè¡¨è¾¾å¼è®¡ç®—åçš„å€¼æ›¿æ¢è¿›å»ã€‚

```python
w = 'ab'
str = f'a{w}'
print(str) # aab
```

Python 3.8ä¹‹åï¼Œå¯ä½¿ç”¨ = ç¬¦å·æ‹¼æ¥è¿ç®—è¡¨è¾¾å¼å’Œç»“æœï¼š

```python
x = 1
print(f'{x+1=}')  # x+1=2
```

**Unicodeå­—ç¬¦ä¸²**

Python3ä¸­ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²éƒ½æ˜¯Unicodeå­—ç¬¦ä¸²

**éƒ¨åˆ†å­—ç¬¦ä¸²å†…å»ºå‡½æ•°**

| å‡½æ•°             | æè¿°                         |
| ---------------- | ---------------------------- |
| capitalize()     | å°†å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ |
| len(string)      | å­—ç¬¦ä¸²é•¿åº¦                   |
| upper()ã€lower() | è½¬æ¢å¤§å°å†™å­—æ¯               |



### 8. Pythonåˆ—è¡¨

åˆ—è¡¨æ•°æ®é¡¹ä¸éœ€è¦å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚

```python
list1 = [1, 2, 3, 4]
list2 = ['a', 'b', 'c']
# è®¿é—®åˆ—è¡¨ä¸­çš„å€¼
print(list1[1])	# 2
print(list1[1:3])	# [2,3]
# æ›´æ–°åˆ—è¡¨
list1[0] = 0
print(list1[0])	# 0
# åˆ é™¤åˆ—è¡¨å…ƒç´ 
del list1[0]
print(list1)	# [2,3,4]
print(len(list2)) # 3
# åˆ—è¡¨è„šæœ¬æ“ä½œç¬¦ï¼Œ+ï¼šç»„åˆåˆ—è¡¨ï¼Œ*ï¼šé‡å¤åˆ—è¡¨
print(list1+list2)	# [2,3,4,'a','b','c']
print(list1*2)	# [2,3,4,2,3,4]
# åˆ—è¡¨æˆªå–
print(list1[-1])	# 4
print(list2[1:])	# ['b','c']
# åˆ—è¡¨æ‹¼æ¥
list1 += [1, 2, 3]
print(list1)	# [2,3,4,1,2,3]
# åµŒå¥—åˆ—è¡¨
list3 = [list1, list2]
print(list3[1])	# ['a','b','c']
print(list3[1][1])	# b
```

**éƒ¨åˆ†åˆ—è¡¨å‡½æ•°å’Œæ–¹æ³•**

| å‡½æ•°/æ–¹æ³•            | æè¿°                           |
| -------------------- | ------------------------------ |
| list(seq)            | å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨                 |
| list.append(obj)     | åœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°å¯¹è±¡           |
| list.reverse()       | åå‘åˆ—è¡¨çš„å…ƒç´                  |
| list.remove(obj)     | ç§»é™¤åˆ—è¡¨ä¸­æŸä¸ªå€¼çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ |
| list.clear()         | æ¸…ç©ºåˆ—è¡¨                       |
| max(list)ã€min(list) | è¿”å›åˆ—è¡¨å…ƒç´ çš„æœ€å¤§å€¼/æœ€å°å€¼    |



### 9. Pythonå…ƒç»„

å…ƒç»„ä½¿ç”¨å°æ‹¬å·ï¼Œå…ƒç»„çš„å…ƒç´ ä¸èƒ½ä¿®æ”¹ï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚

å…ƒç»„çš„ä¸å¯å˜æŒ‡å…ƒç»„æ‰€æŒ‡å‘çš„å†…å­˜ä¸­çš„å†…å®¹ä¸å¯å˜ã€‚

```python
tup1 = (1, 2, 3, 4)
print(type(tup1)) # <class 'tuple'>
print(id(tup1))	# 3246458952584
# ç©ºå…ƒç»„
tup2 = ()
# å…ƒç»„ä¸­åªå«ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¦åœ¨å…ƒç´ åé¢åŠ é€—å·å¦åˆ™æ‹¬å·ä¼šè¢«å½“ä½œè¿ç®—ç¬¦ä½¿ç”¨
tup3 = (20)
print(type(tup3))	# <class 'int'>
tup4 = (20,)	
print(type(tup4))	# <class 'tuple'>
# è®¿é—®å…ƒç»„çš„å€¼ï¼Œå…ƒç»„æˆªå–
print(tup1[1:3])	# (2,3)
# å…ƒç»„æ‹¼æ¥å’Œå…ƒç»„è¿ç®—ç¬¦
tup5 = tup1+tup4
print(tup5)	# (1,2,3,4,20)
print(tup4*3)	# (20,20,20)
# å…ƒç»„ä¸­å…ƒç´ å€¼ä¸å…è®¸ä¿®æ”¹ï¼Œä¸‹é¢æ“ä½œéæ³•
# tup1[0] = 5
# è¿™æ ·æ›´æ”¹å…ƒç»„ä¸­çš„å…ƒç´ å€¼ï¼Œä½†å·²ç»ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Š
tup1 = (2, 4, 6, 8)
print(id(tup1)) # 3246459038120
# åˆ é™¤å…ƒç»„
del tup1, tup2, tup3, tup4
```

**éƒ¨åˆ†å…ƒç»„å‡½æ•°**

| å‡½æ•°                   | æè¿°                    |
| ---------------------- | ----------------------- |
| len(tuple)             | å…ƒç»„å…ƒç´ ä¸ªæ•°            |
| max(tuple)ã€min(tuple) | å…ƒç»„ä¸­å…ƒç´ æœ€å¤§å€¼/æœ€å°å€¼ |
| tuple(iterable)        | å°†å¯è¿­ä»£åºåˆ—è½¬æ¢ä¸ºå…ƒç»„  |



### 10. Pythonå­—å…¸

å­—å…¸æ˜¯å¯å˜å®¹å™¨ç±»å‹ï¼Œå¯å­˜å‚¨ä»»æ„ç±»å‹å¯¹è±¡ã€‚

å­—å…¸å…ƒç´ ä»¥é”®å€¼å¯¹è¡¨ç¤ºï¼Œé”®å¿…é¡»å”¯ä¸€ï¼Œå¿…é¡»ä¸å¯å˜ï¼Œå¦‚å­—ç¬¦ä¸²ã€æ•°å­—æˆ–å…ƒç»„ï¼Œä½†ä¸èƒ½æ˜¯åˆ—è¡¨ï¼›å€¼ä¸ä¸€å®šå”¯ä¸€ï¼Œå¯ä»¥å–ä»»ä½•æ•°æ®ç±»å‹ã€‚

```python
dict1 = {'name': "Ann", 1: 2, ('1',): 3}
# è®¿é—®å­—å…¸é‡Œçš„å€¼
print(dict1[1])	# 2
print(dict1['name'])	# Ann
print(dict1[('1',)])	# 3
# ä¿®æ”¹å­—å…¸ï¼ˆä¹Ÿå¯ä»¥æ–°å¢æ–°çš„é”®å€¼å¯¹ï¼‰
dict1[1] = 10
print(dict1[1])	# 10
dict1[2] = 20
print(dict1)	# {'name': 'Ann', 1: 10, ('1',): 3, 2: 20}
# åˆ é™¤å­—å…¸å…ƒç´ 
del dict1[2]	
print(dict1)	# {'name': 'Ann', 1: 10, ('1',): 3}
# ä¸å…è®¸åŒä¸€ä¸ªé”®å‡ºç°ä¸¤æ¬¡ã€‚åˆ›å»ºæ—¶å¦‚æœåŒä¸€ä¸ªé”®è¢«èµ‹å€¼ä¸¤æ¬¡ï¼Œåä¸€ä¸ªå€¼ä¼šè¢«è®°ä½
dict2 = {1: 2, 1: 3}
print(dict2[1])	# 3
```

**éƒ¨åˆ†å­—å…¸å‡½æ•°**

| å‡½æ•°          | æè¿°                                 |
| ------------- | ------------------------------------ |
| len(dict)     | è®¡ç®—å­—å…¸å…ƒç´ ä¸ªæ•°ï¼Œå³é”®çš„æ€»æ•°         |
| str(dict)     | è¾“å‡ºå­—å…¸ï¼Œä»¥å¯æ‰“å°çš„å­—ç¬¦ä¸²è¡¨ç¤º       |
| dict.values() | ä»¥åˆ—è¡¨è¿”å›å­—å…¸ä¸­æ‰€æœ‰å€¼               |
| dict.keys()   | ä»¥åˆ—è¡¨è¿”å›ä¸€ä¸ªå­—å…¸æ‰€æœ‰é”®             |
| dict.items()  | ä»¥åˆ—è¡¨è¿”å›å¯éå†çš„ï¼ˆé”®ï¼Œå€¼ï¼‰å…ƒç»„æ•°ç»„ |
| dict.pop(key) | åˆ é™¤é”®ä¸ºkeyçš„é”®å€¼å¯¹                  |



### 11. Pythoné›†åˆ

é›†åˆæ˜¯æ— åºçš„ä¸é‡å¤å…ƒç´ åºåˆ—

å¯ç”¨å¤§æ‹¬å·{ }æˆ–è€…set()å‡½æ•°åˆ›å»ºé›†åˆã€‚åˆ›å»ºç©ºé›†åˆæ—¶å¿…é¡»ç”¨set()è€Œä¸æ˜¯{ }ï¼Œå› ä¸º{ }æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸ã€‚

```python
set1 = {1, 2, 1, 3, 4}
print(set1) # {1,2,3,4}
set2 = set((1, 2, 3))
print(set2)	# {1,2,3}
# ç©ºé›†åˆåˆ›å»º
set0 = set()
set3 = {1, 4, 5}
#é›†åˆaä¸­åŒ…å«è€Œé›†åˆbä¸­ä¸åŒ…å«çš„å…ƒç´ 
print(set3 - set1) # {5}
#é›†åˆaæˆ–é›†åˆbåŒ…å«çš„æ‰€æœ‰å…ƒç´ 
print(set1 | set3)	# {1,2,3,4,5}
#é›†åˆaå’Œé›†åˆbä¸­éƒ½åŒ…å«çš„å…ƒç´ 
print(set1 & set3)	# {1,4}
#ä¸åŒæ—¶åŒ…å«äºé›†åˆaå’Œé›†åˆbçš„å…ƒç´ 
print(set1 ^ set3)	# {2,3,5}
# ç±»ä¼¼åˆ—è¡¨ï¼Œæ”¯æŒé›†åˆæ¨åˆ°å¼
a = {x for x in 'abcrabcrabc' if x not in 'abc'}
print(a)	# {'r'}
# æ·»åŠ å…ƒç´ ï¼Œå¦‚æœå…ƒç´ å·²å­˜åœ¨å°±ä¸è¿›è¡Œä»»ä½•æ“ä½œ
set1.add(6)
print(set1)	# {1,2,3,4,6}
set1.add(1)
print(set1)	# {1,2,3,4,6}
# æ·»åŠ å…ƒç´ å¦ä¸€æ–¹æ³•ï¼Œå‚æ•°å¯ä»¥ä¸ºåˆ—è¡¨ã€å…ƒç»„ã€å­—å…¸ç­‰
set1.update({1, 7})
print(set1)	# {1,2,3,4,6,7}
set1.update([1, 2], [7, 8])
# ç§»é™¤å…ƒç´ ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œä¼šå‘ç”Ÿé”™è¯¯
set1.remove(3)
print(set1)	# {1,2,4,6,7,8}
# set1.remove(10)
# ç§»é™¤å…ƒç´ ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œä¸ä¼šå‘ç”Ÿé”™è¯¯
set1.discard(1)
print(set1)	# {2,4,6,7,8}
set1.discard(11)
print(set1)	# {2,4,6,7,8}
# éšæœºåˆ é™¤é›†åˆä¸­ä¸€ä¸ªå…ƒç´ 
print(set1.pop())	# 2
# è®¡ç®—é›†åˆä¸­å…ƒç´ ä¸ªæ•°
print(len(set1))	# 4
```

**éƒ¨åˆ†é›†åˆå‡½æ•°**

| å‡½æ•°           | æè¿°             |
| -------------- | ---------------- |
| clear()        | æ¸…ç©ºé›†åˆ         |
| difference()   | è¿”å›å¤šä¸ªé›†åˆå·®é›† |
| union()        | è¿”å›ä¸¤ä¸ªé›†åˆå¹¶é›† |
| intersection() | è¿”å›é›†åˆçš„äº¤é›†   |



### 12. PythonåŸºæœ¬æ•°æ®ç±»å‹ä¸ç¼–ç¨‹åŸºç¡€

å˜é‡ä¸éœ€è¦å£°æ˜ï¼Œæ¯ä¸ªå˜é‡ä½¿ç”¨å‰å¿…é¡»èµ‹å€¼ï¼Œå˜é‡èµ‹å€¼åè¯¥å˜é‡æ‰ä¼šè¢«åˆ›å»ºã€‚

**å¤šä¸ªå˜é‡èµ‹å€¼**

```python
a = b = 1
print(a)	# 1
print(b)	# 1
c, d = 'a', 5
print(c)	# a
print(d)	# 5
```

**æ ‡å‡†æ•°æ®ç±»å‹**

- ä¸å¯å˜æ•°æ®ï¼šNumberï¼ˆæ•°å­—ï¼‰ã€Stringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€Tupleï¼ˆå…ƒç»„ï¼‰
- å¯å˜æ•°æ®ï¼šListï¼ˆåˆ—è¡¨ï¼‰ã€Dictionaryï¼ˆå­—å…¸ï¼‰ã€Setï¼ˆé›†åˆï¼‰

**åˆ¤æ–­ç±»å‹ï¼štype()å’Œisinstance()**

```python
class A:
    pass


class B(A):
    pass


print(type(A()) == A) 	# True
print(type(B()) == A)	# False
print(isinstance(A(), A))	# True
print(isinstance(B(), A))	# True
```

type()ä¸ä¼šè®¤ä¸ºå­ç±»æ˜¯ä¸€ç§çˆ¶ç±»ç±»å‹

isinstance()ä¼šè®¤ä¸ºå­ç±»æ˜¯ä¸€ç§çˆ¶ç±»ç±»å‹

**Pythonæ•°æ®ç±»å‹è½¬æ¢**

| å‡½æ•°      | æè¿°                                         |
| --------- | -------------------------------------------- |
| ord(x)    | å°†ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå®ƒçš„æ•´æ•°å€¼                   |
| eval(str) | è®¡ç®—å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆPythonè¡¨è¾¾å¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯¹è±¡ |

**ç­‰å¾…ç”¨æˆ·è¾“å…¥**

```python
input("\n\næŒ‰ä¸‹enteré”®é€€å‡ºã€‚")
```

**endå…³é”®å­—**

ç”¨äºå°†ç»“æœè¾“å‡ºåˆ°åŒä¸€è¡Œï¼Œæˆ–åœ¨è¾“å‡ºæœ«å°¾æ·»åŠ ä¸åŒå­—ç¬¦

```python
for i in range(0, 4):
    print(i, end=',') #	0,1,2,3,
```

*argsã€**kwargsç”¨æ³•

```python
def foo(*args, **kwargs):
    print ('args = ', args)
    print ('kwargs = ', kwargs)
    print ('---')

if __name__ == '__main__':
    foo(1,2,3,4)
    foo(a=1,b=2,c=3)
    foo(1,2,3,4, a=1,b=2,c=3)
    foo('a', 1, None, a=1, b='2', c=3)
    
'''
args =  (1, 2, 3, 4)
kwargs =  {}
---
args =  ()
kwargs =  {'a': 1, 'b': 2, 'c': 3}
---
args =  (1, 2, 3, 4)
kwargs =  {'a': 1, 'b': 2, 'c': 3}
---
args =  ('a', 1, None)
kwargs =  {'a': 1, 'b': '2', 'c': 3}
---
'''
```

- `*args`è¡¨ç¤ºä»»ä½•å¤šä¸ªæ— åå‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå…ƒç»„
- `**kwargs`è¡¨ç¤ºå…³é”®å­—å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå­—å…¸
- åŒæ—¶ä½¿ç”¨ `*args`å’Œ `**kwargs`æ—¶ï¼Œå¿…é¡» `*args`å‚æ•°åˆ—è¦åœ¨ `**kwargs`å‰



### 13. Pythonè¿­ä»£å™¨ä¸ç”Ÿæˆå™¨

**13.1 è¿­ä»£å™¨**

è¿­ä»£å™¨æ˜¯è®¿é—®é›†åˆå…ƒç´ çš„ä¸€ç§æ–¹å¼ã€‚è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯ä»¥è®°ä½éå†çš„ä½ç½®çš„å¯¹è±¡ã€‚è¿­ä»£å™¨å¯¹è±¡ä»é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹è®¿é—®ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ è¢«è®¿é—®å®Œç»“æŸã€‚è¿­ä»£å™¨åªèƒ½å¾€å‰ä¸èƒ½åé€€ã€‚å­—ç¬¦ä¸²ã€å…ƒç»„æˆ–åˆ—è¡¨éƒ½å¯åˆ›å»ºè¿­ä»£å™¨ã€‚

```python
import sys
list = [1,2,3]
it = iter(list)

while True:
    try:
        print(next(it))
    except StopIteration:
        sys.exit()
```

iter()åˆ›å»ºè¿­ä»£å™¨å¯¹è±¡ã€next()è¾“å‡ºè¿­ä»£å™¨ä¸‹ä¸€å…ƒç´ 

**åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨**

```python
class A:
    def __iter__(self):
        self.a = 1
        return self

    def __next__(self):
        x = self.a
        self.a += 2
        return x

myA = A()
myiter = iter(myA)
print(next(myiter))	# 1
print(next(myiter))	# 3
print(next(myiter))	# 5
```

**StopIteration**

ç”¨äºè¡¨ç¤ºè¿­ä»£çš„å®Œæˆï¼Œé˜²æ­¢å‡ºç°æ— é™å¾ªç¯æƒ…å†µã€‚

```python
class A:
    def __iter__(self):
        self.a = 1
        return self

    def __next__(self):
        if self.a <= 7:
            x = self.a
            self.a += 2
            return x
        else:
            raise  StopIteration


myA = A()
myiter = iter(myA)
for x in myiter:
    print(x, end=" ")	# 1 3 5 7
```

**13.2 ç”Ÿæˆå™¨**

ä½¿ç”¨äº†yieldçš„å‡½æ•°è¢«ç§°ä¸ºç”Ÿæˆå™¨ã€‚ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªè¿”å›è¿­ä»£å™¨çš„å“ˆæ•°ï¼Œåªèƒ½ç”¨äºè¿­ä»£æ“ä½œã€‚

åœ¨è°ƒç”¨ç”Ÿæˆå™¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡é‡åˆ°yieldæ—¶å‡½æ•°ä¼šæš‚åœå¹¶ä¿å­˜å½“å‰æ‰€æœ‰çš„è¿è¡Œä¿¡æ¯ï¼Œè¿”å›yieldçš„å€¼ï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œnext()æ–¹æ³•æ—¶ä»å½“å‰ä½ç½®ç»§ç»­è¿è¡Œã€‚

```python
import sys


def fibonacci(n):  # ç”Ÿæˆå™¨å‡½æ•° - æ–æ³¢é‚£å¥‘
    a, b, counter = 0, 1, 0
    while True:
        if (counter > n):
            return
        yield a
        a, b = b, a + b
        counter += 1


f = fibonacci(5)  # f æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”±ç”Ÿæˆå™¨è¿”å›ç”Ÿæˆ

while True:
    try:
        print(next(f), end=" ")	# 0 1 1 2 3 5
    except StopIteration:
        sys.exit()
```



### 14. Python æ¨¡å—

æ¨¡å—æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä½ å®šä¹‰çš„å‡½æ•°å’Œå˜é‡çš„æ–‡ä»¶ï¼Œåç¼€åæ˜¯.pyã€‚æ¨¡å—å¯ä»¥è¢«åˆ«çš„ç¨‹åºå¼•å…¥ï¼Œä»¥ä½¿ç”¨è¯¥æ¨¡å—ä¸­çš„å‡½æ•°ç­‰åŠŸèƒ½ã€‚è¿™ä¹Ÿæ˜¯ä½¿ç”¨Pythonæ ‡å‡†åº“çš„æ–¹æ³•ã€‚

**importè¯­å¥**

**from...importè¯­å¥**ï¼šä»æ¨¡å—ä¸­å¯¼å…¥ä¸€ä¸ªåªå½“çš„éƒ¨åˆ†åˆ°å‘½åç©ºé—´ä¸­

**from...import * è¯­å¥**ï¼šæŠŠä¸€ä¸ªæ¨¡å—æ‰€æœ‰å†…å®¹å…¨éƒ¨å¯¼å…¥åˆ°å½“å‰å‘½åç©ºé—´

**dir()å‡½æ•°**

æ‰¾åˆ°æ¨¡å—å†…å®šä¹‰çš„æ‰€æœ‰åç§°ã€‚ä»¥ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨å½¢å¼è¿”å›

å¦‚æœæ²¡æœ‰ç»™å®šå‚æ•°ï¼Œdir()å‡½æ•°ç½—åˆ—å‡ºå½“å‰å®šä¹‰çš„æ‰€æœ‰åç§°

```python
a = [1,2,3]
import sys
# ['__annotations__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', 'a', 'sys']
print(dir())
# omit
print(dir(sys))
```

**åŒ…ã€ä»ä¸€ä¸ªåŒ…ä¸­å¯¼å…¥ ***

åŒ…æ˜¯ä¸€ç§ç®¡ç†Pythonæ¨¡å—å‘½åç©ºé—´çš„å½¢å¼ï¼Œé‡‡ç”¨â€œç‚¹æ¨¡å—åç§°â€ã€‚

å¦‚ä¸€ä¸ªæ¨¡å—åç§°æ˜¯A.Bï¼Œè¡¨ç¤ºä¸€ä¸ªåŒ…Aä¸­çš„å­æ¨¡å—B



### 15. Python Fileï¼ˆæ–‡ä»¶ï¼‰

open()å‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿”å›æ–‡ä»¶å¯¹è±¡ã€‚å¦‚æœè¯¥æ–‡ä»¶æ— æ³•è¢«æ‰“å¼€ï¼Œä¼šæŠ›å‡ºOSErrorã€‚

â­open()æ–¹æ³•ä¸€å®šè¦ä¿è¯å…³é—­æ–‡ä»¶å¯¹è±¡ï¼Œå³è°ƒç”¨close()æ–¹æ³•ã€‚

å¸¸ç”¨å½¢å¼ä¸ºï¼š`open(file,mode='r')`

modeå‚æ•°ï¼š

| æ¨¡å¼ | æè¿°                                                         |
| ---- | ------------------------------------------------------------ |
| t    | æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰                                             |
| x    | å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ä¼šæŠ¥é”™                 |
| b    | äºŒè¿›åˆ¶æ¨¡å¼                                                   |
| r    | ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶çš„æŒ‡é’ˆä¼šæ”¾åœ¨æ–‡ä»¶å¼€å¤´ï¼Œæ˜¯é»˜è®¤æ¨¡å¼     |
| w    | æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ |
| w+   | æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ |
| a    | æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚ |
| r+   | æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚           |

fileå¯¹è±¡ï¼š

ä½¿ç”¨openå‡½æ•°åˆ›å»º

| æ–¹æ³•                       | æè¿°                                                         |
| -------------------------- | ------------------------------------------------------------ |
| file.close()               | å…³é—­æ–‡ä»¶ã€‚å…³é—­åæ–‡ä»¶ä¸èƒ½å†è¿›è¡Œè¯»å†™                           |
| file.flush()               | åˆ·æ–°æ–‡ä»¶å†…éƒ¨ç¼“å†²ï¼Œç›´æ¥æŠŠå†…éƒ¨ç¼“å†²åŒºçš„æ•°æ®ç«‹åˆ»å†™å…¥æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è¢«åŠ¨åœ°ç­‰å¾…è¾“å‡ºç¼“å†²åŒºå†™å…¥ |
| file.write(str)            | å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ï¼Œè¿”å›çš„æ˜¯å†™å…¥çš„å­—ç¬¦é•¿åº¦                     |
| file.read([size])          | ä»æ–‡ä»¶è¯»å–æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå¦‚æœæœªç»™å®šæˆ–ä¸ºè´Ÿåˆ™è¯»å–æ‰€æœ‰           |
| file.seek(offset[,whence]) | ç§»åŠ¨æ–‡ä»¶è¯»å–æŒ‡é’ˆåˆ°æŒ‡å®šä½ç½®                                   |

```python
f = open('a.txt', mode='w+')
f.write("abcd")
f.seek(0)
print(f.read())	# abcd
```



### 16. Python OS

osæ¨¡å—æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥å¤„ç†æ–‡ä»¶å’Œç›®å½•ï¼š

| æ–¹æ³•                 | æè¿°             |
| -------------------- | ---------------- |
| os.access(path.mode) | æ£€éªŒæƒé™æ¨¡å¼     |
| os.chdir(path)       | æ”¹å˜å½“å‰å·¥ä½œç›®å½• |
| os.getcwd()          | è¿”å›å½“å‰å·¥ä½œç›®å½• |
| os.chmod(path,mode)  | æ›´æ”¹æƒé™         |



### â­17. Python å†…å­˜ç®¡ç†

pythonå†…å­˜ç®¡ç†æ˜¯ç”±ç§æœ‰å †ç©ºé—´ç®¡ç†çš„ï¼Œæ‰€æœ‰çš„pythonå¯¹è±¡å’Œæ•°æ®ç»“æ„éƒ½å­˜å‚¨åœ¨ç§æœ‰å †ç©ºé—´ä¸­ã€‚ç¨‹åºå‘˜æ²¡æœ‰è®¿é—®å †çš„æƒé™ï¼Œåªæœ‰è§£é‡Šå™¨æ‰èƒ½æ“ä½œã€‚ä¸ºpythonçš„å †ç©ºé—´åˆ†é…å†…å­˜çš„æ˜¯pythonçš„å†…å­˜ç®¡ç†æ¨¡å—è¿›è¡Œçš„ï¼Œæ ¸å¿ƒapiä¼šæä¾›ä¸€äº›è®¿é—®è¯¥æ¨¡å—çš„æ–¹æ³•ä¾›ç¨‹åºå‘˜ä½¿ç”¨ã€‚pythonè‡ªæœ‰çš„åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶å¹¶é‡Šæ”¾æ²¡æœ‰è¢«ä½¿ç”¨çš„å†…å­˜ä¾›åˆ«çš„ç¨‹åºä½¿ç”¨ã€‚

**17.1 å¯¹è±¡çš„å†…å­˜ä½¿ç”¨**

```python
a = 2
b = 2
print(a is b)	# True

a = "ab"
b = "ab"
print(a is b)	# True

a = []
b = []
print(a is b)	# False
```

pythonç¼“å­˜äº†æ•´æ•°å’ŒçŸ­å­—ç¬¦ä¸²ï¼Œå› æ­¤æ¯ä¸ªå¯¹è±¡åªå­˜æœ‰ä¸€ä»½ï¼Œä½¿ç”¨èµ‹å€¼è¯­å¥åªæ˜¯åˆ›é€ äº†æ–°çš„å¼•ç”¨è€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚

**17.2 å¼•ç”¨è®¡æ•°**

```python
from sys import getrefcount
a = [1, 2, 3]
print(getrefcount(a))   # 2
b = a
print(getrefcount(b))   # 3
```

pythonæ¯ä¸ªå¯¹è±¡éƒ½å­˜æœ‰æŒ‡å‘è¯¥å¯¹è±¡çš„å¼•ç”¨æ€»æ•°ã€‚

å½“ä½¿ç”¨æŸä¸ªå¼•ç”¨ä½œä¸ºå‚æ•°ï¼Œä¼ é€’ç»™getrefcount()æ—¶ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å¼•ç”¨ï¼Œæ‰€ä»¥ç»“æœæ¯”é¢„æœŸå¤š1.

**å¯¹è±¡å¼•ç”¨å¯¹è±¡**

```python
class from_obj():
    def __init__(self, to_obj):
        self.to_obj = to_obj


b = [1, 2, 3]
a = from_obj(b)
print(a.to_obj is b) # True
```

å®¹å™¨å¯¹è±¡ä¸­åŒ…å«çš„å¹¶ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯æŒ‡å‘å„ä¸ªå…ƒç´ å¯¹è±¡çš„å¼•ç”¨

```python
from sys import getrefcount
a = [1, 2, 3]
print(getrefcount(a))	# 2
b = [a, a]	
print(getrefcount(a))	# 4
```

å¯¹è±¡bå¼•ç”¨äº†aä¸¤æ¬¡ï¼Œaå¼•ç”¨è®¡æ•°åŠ 2

ğŸ”ºä¸¤ä¸ªå¯¹è±¡å¯èƒ½äº’ç›¸å¼•ç”¨ï¼Œæ„æˆ**å¼•ç”¨ç¯**ã€‚å³ä½¿æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåªéœ€è‡ªå·±å¼•ç”¨è‡ªå·±ï¼Œä¹Ÿèƒ½æ„æˆå¼•ç”¨ç¯ã€‚å¼•ç”¨ç¯ç»™åƒåœ¾å›æ”¶æœºåˆ¶å¸¦æ¥å¾ˆå¤§éº»çƒ¦ã€‚

```python
a = []
b = [a]
a.append(b)
print(a) # [[[...]]]
```

```python
from sys import getrefcount
a = []
a.append(a)
print(getrefcount(a))	# 3
```

**å¼•ç”¨å‡å°‘**

delå…³é”®å­—åˆ é™¤æŸä¸ªå¼•ç”¨

```python
from sys import getrefcount
a = [1,2,3]
b = a
print(getrefcount(b))	# 3
del a
print(getrefcount(b))	# 2
```

å¦‚æœæŸä¸ªå¼•ç”¨æŒ‡å‘å¯¹è±¡aï¼Œå½“è¿™ä¸ªå¼•ç”¨è¢«é‡æ–°å®šå‘åˆ°å…¶ä»–å¯¹è±¡bæ—¶ï¼Œå¯¹è±¡aå¼•ç”¨è®¡æ•°ä¼šå‡å°‘

```python
from sys import getrefcount
a = [1,2,3]
b = a
print(getrefcount(b))	# 3
a = 1
print(getrefcount(b))	# 2
```

**17.3 åƒåœ¾å›æ”¶**

pythonä¼šåœ¨é€‚å½“æ—¶å€™å¯åŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå°†æ²¡ç”¨çš„å¯¹è±¡æ¸…é™¤ã€‚

**åŸç†**ï¼šå½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°é™ä¸º0æ—¶è¯´æ˜æ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘å¯¹è±¡ï¼Œè¿™æ—¶è¯¥å¯¹è±¡æˆä¸ºéœ€è¦è¢«æ¸…é™¤çš„åƒåœ¾ã€‚

åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œpythonä¸èƒ½è¿›è¡Œå…¶ä»–ä»»åŠ¡ï¼›é¢‘ç¹çš„åƒåœ¾å›æ”¶ä¼šå¤§å¤§é™ä½pythonå·¥ä½œæ•ˆç‡ã€‚å¦‚æœå†…å­˜ä¸­å¯¹è±¡ä¸å¤šï¼Œæ²¡å¿…è¦æ€»å¯åŠ¨åƒåœ¾å›æ”¶ã€‚pythonåªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨åƒåœ¾å›æ”¶ã€‚

**pythonè¿è¡Œæ—¶ï¼Œè®°å½•å…¶ä¸­åˆ†é…å¯¹è±¡å’Œå–æ¶ˆåˆ†é…å¯¹è±¡çš„æ¬¡æ•°ï¼Œä¸¤è€…å·®å€¼é«˜äºæŸä¸ªé˜ˆå€¼æ—¶ï¼Œåƒåœ¾å›æ”¶æ‰ä¼šå¯åŠ¨**

```python
import gc
print(gc.get_threshold()) # (700,10,10)
```

è¿”å›å€¼ä¸­åé¢ä¸¤ä¸ª10ï¼Œæ˜¯ä¸åˆ†ä»£å›æ”¶ç›¸å…³çš„é˜ˆå€¼ï¼Œ700æ˜¯åƒåœ¾å›æ”¶çš„å¯åŠ¨é˜ˆå€¼ã€‚å¯é€šè¿‡gcä¸­çš„ `set_threshold()`æ¥é‡æ–°è®¾å®šã€‚ä¹Ÿå¯æ‰‹åŠ¨ä½¿ç”¨ `gc.collect()`å¯åŠ¨åƒåœ¾å›æ”¶æœºåˆ¶

**17.4 åˆ†ä»£å›æ”¶**

**åŸºæœ¬å‡è®¾**ï¼šå­˜æ´»æ—¶é—´è¶Šä¹…çš„å¯¹è±¡ï¼Œè¶Šä¸å¯èƒ½åœ¨åé¢çš„ç¨‹åºä¸­å˜æˆåƒåœ¾ã€‚æˆ‘ä»¬çš„ç¨‹åºå¾€å¾€ä¼šäº§ç”Ÿå¤§é‡çš„å¯¹è±¡ï¼Œè®¸å¤šå¯¹è±¡å¾ˆå¿«äº§ç”Ÿå’Œæ¶ˆå¤±ï¼Œä½†ä¹Ÿæœ‰é•¿æœŸå­˜åœ¨è¢«ä½¿ç”¨çš„å¯¹è±¡ï¼Œå‡ºäºä¿¡ä»»å’Œæ•ˆç‡ï¼Œå¯¹äºè¿™æ ·ä¸€äº›å¯¹è±¡ï¼Œæˆ‘ä»¬ç›¸ä¿¡ä»–çš„ç”¨å¤„ï¼Œæ‰€ä»¥å‡å°‘åœ¨åƒåœ¾å›æ”¶ä¸­æ‰«æä»–ä»¬çš„é¢‘ç‡ã€‚

pythonå°†æ‰€æœ‰çš„å¯¹è±¡åˆ†ä¸º0,1,2ä¸‰ä»£ï¼Œæ‰€æœ‰æ–°å»ºçš„å¯¹è±¡éƒ½æ˜¯0ä»£å¯¹è±¡ï¼Œå½“æŸä¸€ä»£å¯¹è±¡ç»å†è¿‡åƒåœ¾å›æ”¶ä¹‹åï¼Œä¾ç„¶å­˜æ´»ï¼Œé‚£å°±å½’å…¥åˆ°ä¸‹ä¸€ä»£ä¸­ï¼Œåƒåœ¾å›æ”¶å¯åŠ¨æ—¶ï¼Œä¸€å®šä¼šæ‰«ææ‰€æœ‰çš„0ä»£å¯¹è±¡ã€‚å¦‚æœ0ä»£å¯¹è±¡ç»å†è¿‡ä¸€å®šæ¬¡æ•°çš„åƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆå°±å¯åŠ¨å¯¹0ä»£å’Œ1ä»£çš„æ‰«ææ¸…ç†ï¼Œå½“1ä»£ä¹Ÿç»å†äº†ä¸€å®šæ•°é‡çš„åƒåœ¾å›æ”¶ï¼Œé‚£å°±å¯åŠ¨å¯¹0,1,2ä»£å³æ‰€æœ‰çš„å¯¹è±¡è¿›è¡Œæ‰«æã€‚

ä¸Šè¿° `gc.get_threshold()`è¿”å›çš„ï¼ˆ700ï¼Œ10ï¼Œ10ï¼‰è¡¨ç¤ºï¼š**æ¯ç»è¿‡10æ¬¡å¯¹0ä»£çš„åƒåœ¾å›æ”¶ï¼Œå°±ä¼šé…åˆå¯åŠ¨ä¸€æ¬¡å¯¹1ä»£çš„æ‰«æï¼›æ¯ç»è¿‡10æ¬¡å¯¹1ä»£çš„æ‰«æï¼Œæ‰å¯åŠ¨ä¸€æ¬¡å¯¹2ä»£çš„åƒåœ¾å›æ”¶**

**17.5 å­¤ç«‹çš„å¼•ç”¨ç¯**

å¼•ç”¨ç¯å¯èƒ½æ„æˆæ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯å¼•ç”¨è®¡æ•°ä¸ä¸º0çš„å¯¹è±¡

ä¸ºäº†å›æ”¶è¿™æ ·çš„å¼•ç”¨ç¯ï¼Œ**pythonå¤åˆ¶æ¯ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œè®°ä¸ºgc_refã€‚å‡è®¾å¯¹äºæ¯ä¸ªå¯¹è±¡iï¼Œè®¡æ•°ä¸ºgc_ref_iã€‚pythonä¼šéå†æ‰€æœ‰å¯¹è±¡iï¼Œå¯¹äºæ¯ä¸ªå¯¹è±¡iå¼•ç”¨çš„å¯¹è±¡jï¼Œå°†ç›¸åº”gc_ref_jå‡1**ã€‚ç»“æŸéå†åï¼Œgc_refä¸ä¸º0çš„å¯¹è±¡å’Œè¿™äº›å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ä»¥åŠç»§ç»­æ›´ä¸‹æ¸¸å¼•ç”¨çš„å¯¹è±¡éœ€è¦è¢«ä¿ç•™ï¼Œå…¶ä»–å¯¹è±¡åˆ™è¢«åƒåœ¾å›æ”¶ã€‚



### â­18. Pythonè£…é¥°å™¨

**18.1 æœ¬è´¨å’ŒåŠŸèƒ½**

æœ¬è´¨ï¼šä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼ˆé«˜é˜¶å‡½æ•°+åµŒå¥—å‡½æ•°ï¼‰

åŠŸèƒ½ï¼šåœ¨ä¸ä¿®æ”¹åŸå‡½æ•°ä»¥åŠå…¶è°ƒç”¨æ–¹å¼æƒ…å†µä¸‹å¯¹åŸå‡½æ•°åŠŸèƒ½è¿›è¡Œæ‰©å±•

**18.2 é—­åŒ…åŸç†**

```python
def print_msg():
    msg = "is a closure"

    def printer():
        print(msg)

    return printer

closure = print_msg()
closure()	# è¾“å‡º is a closure
```

é—­åŒ…å°±æ˜¯å¼•ç”¨äº†è‡ªæœ‰å˜é‡çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¿å­˜äº†æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥è„±ç¦»åŸæœ¬ä½œç”¨åŸŸç‹¬ç«‹å­˜åœ¨ã€‚

**18.3 è£…é¥°å™¨**

```python
import functools


def log(func):
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        print('call %s():' % func.__name__)
        print('args = {}'.format(*args))
        return func(*args, **kwargs)

    return wrapper


@log
def test(p):
    print(test.__name__ + " param: " + p)


test("I'm a param")

'''
call test():
args = I'm a param
test param: I'm a param
'''
```

ä¸Šé¢çš„@è¯­æ³•åªæ˜¯å°†å‡½æ•°ä¼ å…¥è£…é¥°å™¨å‡½æ•°ï¼Œä¸‹é¢è¿™ä¸ªå†™æ³•ç»“æœä¸€æ ·ï¼š

```python
def test(p):
    print(test.__name__ + " param: " + p)


wrapper = log(test)
wrapper("I'm a param")
```

ğŸ”º `@functions.wraps(func)`æ˜¯pythonæä¾›çš„è£…é¥°å™¨ï¼Œå¯ä»¥æŠŠåŸå‡½æ•°çš„å…ƒä¿¡æ¯æ‹·è´åˆ°è£…é¥°å™¨é‡Œé¢çš„funcå‡½æ•°ä¸­ã€‚å‡½æ•°å…ƒä¿¡æ¯åŒ…æ‹¬docstringã€nameã€å‚æ•°åˆ—è¡¨ç­‰ã€‚

**18.4 å¸¦å‚æ•°çš„è£…é¥°å™¨**

```python
import functools


def log_with_param(text):
    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            print('call %s():' % func.__name__)
            print('args = {}'.format(*args))
            print('log_param = {}'.format(text))
            return func(*args, **kwargs)

        return wrapper

    return decorator


def test_with_param(p):
    print(test_with_param.__name__)
    
# ä¼ å…¥è£…é¥°å™¨çš„å‚æ•°ï¼Œå¹¶æ¥æ”¶è¿”å›çš„decoratorå‡½æ•°
decorator = log_with_param("param")
# ä¼ å…¥test_with_paramå‡½æ•°
wrapper = decorator(test_with_param)
# è°ƒç”¨è£…é¥°å™¨å‡½æ•°
wrapper("I'm a param")

'''
call test_with_param():
args = I'm a param
log_param = param
test_with_param
'''
```

ä¸€ä¸ªæºå¸¦äº†å‚æ•°çš„è£…é¥°å™¨å°†æœ‰ä¸‰å±‚å‡½æ•°

**18.5 ç±»è£…é¥°å™¨**

```python
class DecorateDemo(object):
    def  __init__(self, func):
        self.__func = func
    def  __call__(self):
        print("before class decorator")
        self.__func()
        print("after class decorator")
        return self.__func

@DecorateDemo
def test():
    print("this is what I want")

test()

'''
before class decorator
this is what I want
after class decorator
'''
```

ç”¨æ³•ï¼šè®©ç±»çš„æ„é€ å‡½æ•° `__init__()`æ¥æ”¶ä¸€ä¸ªå‚æ•° ğŸ‘‰ é‡è½½ `__call__()`å¹¶è¿”å›ä¸€ä¸ªå‡½æ•° ğŸ‘‰ ä½¿ç”¨ `@ç±»`å½¢å¼å°†è£…é¥°å™¨é™„åŠ åˆ°ä¸šåŠ¡å‡½æ•°ä¸Š

**18.6 å¤šä¸ªè£…é¥°å™¨**

```python
def log(func):
    def wrapper():
        print("call test()")
        result = func()
        print("end test()")
        return result 
    return wrapper

def hello(func):
    def wrapper():
        print("hello test()")
        result = func()
        print("goodbye test()")
        return result 
    return wrapper

@log
@hello
def test():
    print("this is what I want")

test()

'''
call test()
hello test()
this is what I want
goodbye test()
end test()
'''
```

å…ˆè°ƒç”¨æœ€é‡Œå±‚è£…é¥°å™¨ï¼Œæœ€åè°ƒç”¨æœ€å¤–å±‚è£…é¥°å™¨



### â­19. Pythonå¤šçº¿ç¨‹

å‚è€ƒè‡ªï¼š [https://www.cnblogs.com/luyuze95/p/11289143.html#%E4%B8%89gilglobal-interpreter-lock%E5%85%A8%E5%B1%80%E8%A7%A3%E9%87%8A%E5%99%A8%E9%94%81](https://www.cnblogs.com/luyuze95/p/11289143.html#ä¸‰gilglobal-interpreter-lockå…¨å±€è§£é‡Šå™¨é”)

**19.1 å¤šçº¿ç¨‹å®ç°**

**threadingæ¨¡å—**

```python
import threading
import time

def run(n):
    print("task", n)
    time.sleep(1)
    print('2s')
    time.sleep(1)
    print('1s')
    time.sleep(1)
    print('0s')
    time.sleep(1)


if __name__ == '__main__':
    t1 = threading.Thread(target=run, args=("t1",))
    t2 = threading.Thread(target=run, args=("t2",))
    t1.start()
    t2.start()
    
'''
task t1
task t2
2s
2s
1s
1s
0s
0s
'''
```

**è‡ªå®šä¹‰çº¿ç¨‹**

```python
import threading
import time


class MyThread(threading.Thread):
    def __init__(self, n):
        super(MyThread, self).__init__()  # é‡æ„runå‡½æ•°å¿…é¡»è¦å†™
        self.n = n

    def run(self):
        print("task", self.n)
        time.sleep(1)
        print('2s')
        time.sleep(1)
        print('1s')
        time.sleep(1)
        print('0s')
        time.sleep(1)

if __name__ == "__main__":
    t1 = MyThread("t1")
    t2 = MyThread("t2")
    t1.start()
    t2.start()
    
'''
task t1
task t2
2s
2s
1s
1s
0s
0s
'''
```

**å®ˆæŠ¤çº¿ç¨‹**

æŠŠæ‰€æœ‰å­çº¿ç¨‹å˜æˆäº†ä¸»çº¿ç¨‹çš„å®ˆæŠ¤çº¿ç¨‹ï¼Œå› æ­¤å½“ä¸»çº¿ç¨‹ç»“æŸä¹‹åå­çº¿ç¨‹ä¹Ÿä¼šéšä¹‹ç»“æŸã€‚æ‰€ä»¥å½“ä¸»çº¿ç¨‹ç»“æŸä¹‹åï¼Œæ•´ä¸ªç¨‹åºå°±é€€å‡ºäº†ã€‚

```python
import threading
import time

def run(n):
    print("task", n)
    time.sleep(1)       #æ­¤æ—¶å­çº¿ç¨‹åœ1s
    print('3')
    time.sleep(1)
    print('2')
    time.sleep(1)
    print('1')

if __name__ == '__main__':
    t = threading.Thread(target=run, args=("t1",))
    t.setDaemon(True)   #æŠŠå­è¿›ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¿…é¡»åœ¨start()ä¹‹å‰è®¾ç½®
    t.start()
    print("end")
    
'''
task t1
end
'''
```

**ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ç»“æŸ**

ä½¿ç”¨joinæ–¹æ³•ï¼Œè®©ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œï¼Œè¿™æ ·å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œç»“æŸä¹‹åä¸»çº¿ç¨‹å†ç»“æŸ

```python
import threading
import time

def run(n):
    print("task", n)
    time.sleep(1)       #æ­¤æ—¶å­çº¿ç¨‹åœ1s
    print('3')
    time.sleep(1)
    print('2')
    time.sleep(1)
    print('1')

if __name__ == '__main__':
    t = threading.Thread(target=run, args=("t1",))
    t.setDaemon(True)   #æŠŠå­è¿›ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¿…é¡»åœ¨start()ä¹‹å‰è®¾ç½®
    t.start()
    t.join() # è®¾ç½®ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ç»“æŸ
    print("end")
```

**å¤šçº¿ç¨‹å…±äº«å…¨å±€å˜é‡**

åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šçº¿ç¨‹å…±äº«èµ„æº

```python
import threading
import time

g_num = 100

def work1():
    global g_num
    for i in range(3):
        g_num += 1
    print("in work1 g_num is : %d" % g_num)

def work2():
    global g_num
    print("in work2 g_num is : %d" % g_num)

if __name__ == '__main__':
    t1 = threading.Thread(target=work1)
    t1.start()
    time.sleep(1)
    t2 = threading.Thread(target=work2)
    t2.start()
    
'''
in work1 g_num is : 103
in work2 g_num is : 103
'''
```

**äº’æ–¥é”**

ç”±äºçº¿ç¨‹ä¹‹é—´éšå³è°ƒåº¦ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰å¾ˆå¥½åœ°ä¿æŠ¤è¯¥å¯¹è±¡ï¼Œä¼šé€ æˆç¨‹åºç»“æœçš„ä¸å¯é¢„æœŸï¼Œ**ç§°ä¸ºçº¿ç¨‹ä¸å®‰å…¨**

```python
from threading import Thread,Lock
import os, time


def work():
    global n
    lock.acquire()
    temp=n
    time.sleep(0.1)
    n=temp-1
    lock.release()


if __name__ == '__main__':
    lock=Lock()
    n=100
    l=[]
    for i in range(100):
        p=Thread(target=work)
        l.append(p)
        p.start()
    for p in l:
        p.join()
```

**é€’å½’é”**

RLockç±»æ”¯æŒåµŒå¥—ï¼Œåœ¨å¤šä¸ªé”æ²¡æœ‰é‡Šæ”¾æ—¶ä¸€èˆ¬ä½¿ç”¨RLockç±»

```python
import threading
import time

def Func(lock):
    global gl_num
    lock.acquire()
    gl_num += 1
    time.sleep(1)
    print(gl_num)
    lock.release()

if __name__ == '__main__':
    gl_num = 0
    lock = threading.RLock()
    for i in range(10):
        t = threading.Thread(target=Func, args=(lock,))
        t.start()

'''
// åˆ†10è¡Œè¾“å‡º 1 2 3 ... 9  10
'''
```

**ä¿¡å·é‡BoundedSemaphore**

äº’æ–¥é”åŒæ—¶åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ›´æ”¹æ•°æ®ï¼Œä¿¡å·é‡åŒæ—¶å…è®¸ä¸€å®šæ•°é‡çº¿ç¨‹æ›´æ”¹æ•°æ®

```python
import threading
import time

def run(n, semaphore):
    semaphore.acquire()   #åŠ é”
    time.sleep(1)
    print("run the thread:%s\n" % n)
    semaphore.release()     #é‡Šæ”¾

if __name__ == '__main__':
    num = 0
    semaphore = threading.BoundedSemaphore(5)  # æœ€å¤šå…è®¸5ä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ
    for i in range(12):
        t = threading.Thread(target=run, args=("t-%s" % i, semaphore))
        t.start()
    while threading.active_count() != 1:
        pass  # print threading.active_count()
    else:
        print('-----all threads done-----')
        
'''
run the thread:t-0
run the thread:t-1
run the thread:t-4
run the thread:t-2
run the thread:t-3





run the thread:t-7
run the thread:t-6

run the thread:t-9

run the thread:t-5
run the thread:t-8



run the thread:t-11
run the thread:t-10


-----all threads done-----
'''
```

**äº‹ä»¶ï¼ˆEventç±»ï¼‰**

pythonçº¿ç¨‹çš„äº‹ä»¶ç”¨äºä¸»çº¿ç¨‹æ§åˆ¶å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œäº‹ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„çº¿ç¨‹åŒæ­¥å¯¹è±¡ï¼Œä¸»è¦æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š

- clear()ï¼šå°†flagè®¾ç½®ä¸ºâ€œFalseâ€
- set()ï¼šå°†flagè®¾ç½®ä¸ºâ€œTrueâ€
- is_set()ï¼šåˆ¤æ–­æ˜¯å¦è®¾ç½®äº†flag
- wait()ï¼šä¸€ç›´ç›‘å¬flagï¼Œå¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°flagå°±ä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€

äº‹ä»¶å¤„ç†æœºåˆ¶ï¼šå…¨å±€å®šä¹‰äº†ä¸€ä¸ªâ€œFlagâ€ï¼Œå½“flagå€¼ä¸ºâ€œFalseâ€ï¼Œevent.wait()ä¼šé˜»å¡ï¼›å½“flagå€¼ä¸ºâ€œTrueâ€ï¼Œevent.wait()ä¸å†é˜»å¡

```python
#åˆ©ç”¨Eventç±»æ¨¡æ‹Ÿçº¢ç»¿ç¯
import threading
import time

event = threading.Event()


def lighter():
    count = 0
    event.set()     #åˆå§‹å€¼ä¸ºç»¿ç¯
    while True:
        if 5 < count <=10 :
            event.clear()  # çº¢ç¯ï¼Œæ¸…é™¤æ ‡å¿—ä½
            print("\33[41;1mred light is on...\033[0m")
        elif count > 10:
            event.set()  # ç»¿ç¯ï¼Œè®¾ç½®æ ‡å¿—ä½
            count = 0
        else:
            print("\33[42;1mgreen light is on...\033[0m")

        time.sleep(1)
        count += 1

def car(name):
    while True:
        if event.is_set():      #åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†æ ‡å¿—ä½
            print("[%s] running..."%name)
            time.sleep(1)
        else:
            print("[%s] sees red light,waiting..."%name)
            event.wait()
            print("[%s] green light is on,start going..."%name)

light = threading.Thread(target=lighter,)
light.start()

car = threading.Thread(target=car, args=("MINI",))
car.start()
```

**19.2 GILï¼ˆGlobal Interpreter Lockï¼‰å…¨å±€è§£é‡Šå™¨é”**

**GILä»‹ç»å’ŒèƒŒæ™¯**

åœ¨épythonç¯å¢ƒä¸­ï¼Œå•æ ¸æƒ…å†µä¸‹ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œã€‚å¤šæ ¸æ—¶å¯ä»¥æ”¯æŒå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚ä½†æ˜¯åœ¨pythonä¸­ï¼Œæ— è®ºæœ‰å¤šå°‘æ ¸ï¼ŒåŒæ—¶åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ã€‚ç©¶å…¶åŸå› ï¼Œè¿™å°±æ˜¯ç”±äºGILçš„å­˜åœ¨å¯¼è‡´çš„ã€‚

GILçš„å…¨ç§°æ˜¯Global Interpreter Lock(å…¨å±€è§£é‡Šå™¨é”)ï¼Œæ¥æºæ˜¯pythonè®¾è®¡ä¹‹åˆçš„è€ƒè™‘ï¼Œä¸ºäº†æ•°æ®å®‰å…¨æ‰€åšçš„å†³å®šã€‚æŸä¸ªçº¿ç¨‹æƒ³è¦æ‰§è¡Œï¼Œå¿…é¡»å…ˆæ‹¿åˆ°GILï¼Œæˆ‘ä»¬å¯ä»¥æŠŠGILçœ‹ä½œæ˜¯â€œé€šè¡Œè¯â€ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªpythonè¿›ç¨‹ä¸­ï¼ŒGILåªæœ‰ä¸€ä¸ªã€‚æ‹¿ä¸åˆ°é€šè¡Œè¯çš„çº¿ç¨‹ï¼Œå°±ä¸å…è®¸è¿›å…¥CPUæ‰§è¡Œã€‚GILåªåœ¨cpythonä¸­æ‰æœ‰ï¼Œå› ä¸ºcpythonè°ƒç”¨çš„æ˜¯cè¯­è¨€çš„åŸç”Ÿçº¿ç¨‹ï¼Œæ‰€ä»¥ä»–ä¸èƒ½ç›´æ¥æ“ä½œcpuï¼Œåªèƒ½åˆ©ç”¨GILä¿è¯åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°æ•°æ®ã€‚è€Œåœ¨pypyå’Œjpythonä¸­æ˜¯æ²¡æœ‰GILçš„ã€‚

**pythonå¤šçº¿ç¨‹å·¥ä½œè¿‡ç¨‹**

pythonåœ¨ä½¿ç”¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯cè¯­è¨€çš„åŸç”Ÿçº¿ç¨‹ã€‚

- æ‹¿åˆ°å…¬å…±æ•°æ®
- ç”³è¯·GIL
- pythonè§£é‡Šå™¨è°ƒç”¨osåŸç”Ÿçº¿ç¨‹
- osæ“ä½œcpuæ‰§è¡Œè¿ç®—
- å½“è¯¥çº¿ç¨‹æ‰§è¡Œæ—¶é—´åˆ°åï¼Œæ— è®ºè¿ç®—æ˜¯å¦å·²ç»æ‰§è¡Œå®Œï¼ŒGILéƒ½è¢«è¦æ±‚é‡Šæ”¾
- è¿›è€Œç”±å…¶ä»–è¿›ç¨‹é‡å¤ä¸Šé¢çš„è¿‡ç¨‹
- ç­‰å…¶ä»–è¿›ç¨‹æ‰§è¡Œå®Œåï¼Œåˆä¼šåˆ‡æ¢åˆ°ä¹‹å‰çš„çº¿ç¨‹ï¼ˆä»ä»–è®°å½•çš„ä¸Šä¸‹æ–‡ç»§ç»­æ‰§è¡Œï¼‰ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œè‡ªå·±çš„è¿ç®—ï¼Œå½“æ‰§è¡Œæ—¶é—´åˆ°å°±è¿›è¡Œåˆ‡æ¢ï¼ˆcontext switchï¼‰ã€‚

**pythoné’ˆå¯¹ä¸åŒç±»å‹çš„ä»£ç æ‰§è¡Œæ•ˆç‡ä¸åŒ**

- **CPUå¯†é›†å‹ä»£ç ** (å„ç§å¾ªç¯å¤„ç†ã€è®¡ç®—ç­‰ç­‰)ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºè®¡ç®—å·¥ä½œå¤šï¼Œticksè®¡æ•°å¾ˆå¿«å°±ä¼šè¾¾åˆ°é˜ˆå€¼ï¼Œç„¶åè§¦å‘GILçš„é‡Šæ”¾ä¸å†ç«äº‰ï¼ˆå¤šä¸ªçº¿ç¨‹æ¥å›åˆ‡æ¢å½“ç„¶æ˜¯éœ€è¦æ¶ˆè€—èµ„æºçš„ï¼‰ï¼Œæ‰€ä»¥**pythonä¸‹çš„å¤šçº¿ç¨‹å¯¹CPUå¯†é›†å‹ä»£ç å¹¶ä¸å‹å¥½**ã€‚
- **IOå¯†é›†å‹ä»£ç ** (æ–‡ä»¶å¤„ç†ã€ç½‘ç»œçˆ¬è™«ç­‰æ¶‰åŠæ–‡ä»¶è¯»å†™çš„æ“ä½œ)ï¼Œå¤šçº¿ç¨‹èƒ½å¤Ÿæœ‰æ•ˆæå‡æ•ˆç‡(å•çº¿ç¨‹ä¸‹æœ‰IOæ“ä½œä¼šè¿›è¡ŒIOç­‰å¾…ï¼Œé€ æˆä¸å¿…è¦çš„æ—¶é—´æµªè´¹ï¼Œè€Œå¼€å¯å¤šçº¿ç¨‹èƒ½åœ¨çº¿ç¨‹Aç­‰å¾…æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°çº¿ç¨‹Bï¼Œå¯ä»¥ä¸æµªè´¹CPUçš„èµ„æºï¼Œä»è€Œèƒ½æå‡ç¨‹åºæ‰§è¡Œæ•ˆç‡)ã€‚æ‰€ä»¥**pythonçš„å¤šçº¿ç¨‹å¯¹IOå¯†é›†å‹ä»£ç æ¯”è¾ƒå‹å¥½**ã€‚

**å®é™…ä½¿ç”¨å»ºè®®**

pythonä¸‹æƒ³è¦å……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼Œå°±ç”¨å¤šè¿›ç¨‹ã€‚å› ä¸ºæ¯ä¸ªè¿›ç¨‹æœ‰å„è‡ªç‹¬ç«‹çš„GILï¼Œäº’ä¸å¹²æ‰°ï¼Œè¿™æ ·å°±å¯ä»¥çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶è¡Œæ‰§è¡Œï¼Œåœ¨pythonä¸­ï¼Œå¤šè¿›ç¨‹çš„æ‰§è¡Œæ•ˆç‡ä¼˜äºå¤šçº¿ç¨‹(ä»…ä»…é’ˆå¯¹å¤šæ ¸CPUè€Œè¨€)ã€‚

**GILåœ¨pythonä¸­ç‰ˆæœ¬å·®å¼‚**

- åœ¨python2.xé‡Œï¼ŒGILçš„é‡Šæ”¾é€»è¾‘æ˜¯å½“å‰çº¿ç¨‹é‡è§IOæ“ä½œæˆ–è€…ticksè®¡æ•°è¾¾åˆ°100æ—¶è¿›è¡Œé‡Šæ”¾ã€‚ï¼ˆtickså¯ä»¥çœ‹ä½œæ˜¯pythonè‡ªèº«çš„ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä¸“é—¨åšç”¨äºGILï¼Œæ¯æ¬¡é‡Šæ”¾åå½’é›¶ï¼Œè¿™ä¸ªè®¡æ•°å¯ä»¥é€šè¿‡sys.setcheckinterval æ¥è°ƒæ•´ï¼‰ã€‚è€Œæ¯æ¬¡é‡Šæ”¾GILé”ï¼Œçº¿ç¨‹è¿›è¡Œé”ç«äº‰ã€åˆ‡æ¢çº¿ç¨‹ï¼Œä¼šæ¶ˆè€—èµ„æºã€‚å¹¶ä¸”ç”±äºGILé”å­˜åœ¨ï¼Œpythoné‡Œä¸€ä¸ªè¿›ç¨‹æ°¸è¿œåªèƒ½åŒæ—¶æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹(æ‹¿åˆ°GILçš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œ)ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨å¤šæ ¸CPUä¸Šï¼Œpythonçš„å¤šçº¿ç¨‹æ•ˆç‡å¹¶ä¸é«˜ã€‚
- åœ¨python3.xä¸­ï¼ŒGILä¸ä½¿ç”¨ticksè®¡æ•°ï¼Œæ”¹ä¸ºä½¿ç”¨è®¡æ—¶å™¨ï¼ˆæ‰§è¡Œæ—¶é—´è¾¾åˆ°é˜ˆå€¼åï¼Œå½“å‰çº¿ç¨‹é‡Šæ”¾GILï¼‰ï¼Œè¿™æ ·å¯¹CPUå¯†é›†å‹ç¨‹åºæ›´åŠ å‹å¥½ï¼Œä½†ä¾ç„¶æ²¡æœ‰è§£å†³GILå¯¼è‡´çš„åŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹çš„é—®é¢˜ï¼Œæ‰€ä»¥æ•ˆç‡ä¾ç„¶ä¸å°½å¦‚äººæ„ã€‚



### 20. Pythonå°è£…ã€ç»§æ‰¿ä¸å¤šæ€

**20.1 å°è£…**

å°†æ•°æ®ä¸å…·ä½“æ“ä½œçš„å®ç°ä»£ç æ”¾åœ¨æŸä¸ªå¯¹è±¡å†…éƒ¨ï¼Œå¤–ç•Œåªèƒ½é€šè¿‡æ¥å£ä½¿ç”¨è¯¥å¯¹è±¡è€Œä¸èƒ½é€šè¿‡ä»»ä½•å½¢å¼ä¿®æ”¹å¯¹è±¡å†…éƒ¨å®ç°ã€‚

```python
    class Student:
        def __init__(self,name, age):
            self.name = name
            self.age = age
        def printInfo(self):
            print("name:{}".format(self.name), "age:{}".format(self.age))
    # ä¸‹é¢çš„æ“ä½œéƒ½æ˜¯é”™è¯¯çš„ï¼åŸå› ï¼šç±»å°†å®ƒå†…éƒ¨çš„å˜é‡å’Œæ–¹æ³•å°è£…èµ·æ¥ï¼Œé˜»æ­¢å¤–éƒ¨çš„ç›´æ¥è®¿é—®
    print(name)
    print(age)
    printInfo()
```

**20.2 ç»§æ‰¿**

```python
# çˆ¶ç±»å®šä¹‰
class people:
    def __init__(self, name, age, weight):
        self.name = name
        self.age = age
        self.__weight = weight

    def speak(self):
        print("%s è¯´: æˆ‘ %d å²ã€‚" % (self.name, self.age))


# å•ç»§æ‰¿ç¤ºä¾‹
class student(people):

    def __init__(self, name, age, weight, grade):
        # è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹åŒ–æ–¹æ³•
        people.__init__(self, name, age, weight)
        self.grade = grade

    # é‡å†™çˆ¶ç±»çš„speakæ–¹æ³•
    def speak(self):
        print("%s è¯´: æˆ‘ %d å²äº†ï¼Œæˆ‘åœ¨è¯» %d å¹´çº§" % (self.name, self.age, self.grade))


s = student('ken', 10, 30, 3)
s.speak()

'''
ken è¯´: æˆ‘ 10 å²äº†ï¼Œæˆ‘åœ¨è¯» 3 å¹´çº§
'''
```

**ç»§æ‰¿åŸåˆ™**

- å­ç±»åœ¨è°ƒç”¨æŸä¸ªæ–¹æ³•æˆ–å˜é‡æ—¶ï¼Œé¦–å…ˆåœ¨è‡ªå·±å†…éƒ¨æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™å¼€å§‹æ ¹æ®ç»§æ‰¿æœºåˆ¶åœ¨çˆ¶ç±»æŸ¥æ‰¾

```python
class D:
    pass


class C(D):
    pass


class B(C):
    def show(self):
        print("i am B")

    pass


class G:
    pass


class F(G):
    pass


class E(F):
    def show(self):
        print("i am E")

    pass


class A(B, E):
    pass


a = A()
a.show()

'''
i am B
'''
```

ç»§æ‰¿å‚æ•°ä¹¦å†™æœ‰å…ˆåé¡ºåºï¼Œå†™åœ¨å‰é¢è¢«ä¼˜å…ˆç»§æ‰¿

- æ ¹æ®çˆ¶ç±»å®šä¹‰ä¸­çš„é¡ºåºï¼Œä»¥DFSæ–¹å¼é€ä¸€æŸ¥æ‰¾çˆ¶ç±»

```python
class D:
    def show(self):
        print("i am D")

    pass


class C(D):
    pass


class B(C):
    pass


class G:
    pass


class F(G):
    pass


class E(F):
    def show(self):
        print("i am E")

    pass


class A(B, E):
    pass


a = A()
a.show()

'''
i am D
'''
```

ğŸ”ºå½“ç±»Då’Œç±»GåŒæ—¶ç»§æ‰¿äº†ç±»Hï¼š

```python
class H:
    def show(self):
        print("i am H")

    pass


class D(H):
    pass


class C(D):
    pass


class B(C):
    pass


class G(H):
    pass


class F(G):
    pass


class E(F):
    def show(self):
        print("i am E")

    pass


class A(B, E):
    pass


a = A()
a.show()

'''
i am E
'''
```

ğŸ”ºå…¶ä»–æ›´å¤æ‚ç»§æ‰¿æƒ…å†µ

```python
class D():
    pass


class G():
    def show(self):
        print("i am G")

    pass


class F(G):
    pass


class C(D):
    pass


class B(C, F):
    pass


class E(F):
    def show(self):
        print("i am E")

    pass


class A(B, E):
    pass

a = A()
print(a.show())

'''
i am E
'''
```

**super()å‡½æ•°**

åœ¨å­ç±»ä¸­å¦‚æœæœ‰ä¸çˆ¶ç±»åŒåçš„æˆå‘˜ï¼Œä¼šè¦†ç›–æ‰çˆ¶ç±»é‡Œçš„æˆå‘˜ã€‚å¦‚æœæƒ³å¼ºåˆ¶è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜åˆ™éœ€è¦ä½¿ç”¨super()å‡½æ•°ã€‚ä¼ å…¥å­ç±»åå’Œselfï¼Œè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼ŒæŒ‰çˆ¶ç±»çš„æ–¹æ³•éœ€è¦ä¼ å…¥å‚æ•°

```python
class A:
    def __init__(self, name):
        self.name = name
        print("çˆ¶ç±»çš„__init__æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼")

    def show(self):
        print("çˆ¶ç±»çš„showæ–¹æ³•è¢«æ‰§è¡Œäº†ï¼")


class B(A):
    def __init__(self, name, age):
        super(B, self).__init__(name=name)
        self.age = age

    def show(self):
        super(B, self).show()


obj = B("jack", 18)
obj.show()

'''
çˆ¶ç±»çš„__init__æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼
çˆ¶ç±»çš„showæ–¹æ³•è¢«æ‰§è¡Œäº†ï¼
'''
```

**ç±»å‹åˆ¤æ–­**

ç»§æ‰¿å…³ç³»ä¸­ï¼Œå¦‚æœä¸€ä¸ªå®ä¾‹çš„æ•°æ®ç±»å‹æ˜¯æŸä¸ªå­ç±»ï¼Œé‚£å®ƒçš„æ•°æ®ç±»å‹ä¹Ÿå¯ä»¥è¢«çœ‹åšçˆ¶ç±»ï¼Œä½†åè¿‡æ¥ä¸è¡Œã€‚

```python
class Animal:
    pass


class Dog(Animal):
    pass


dog = Dog()
b = Animal()
print(isinstance(b, Dog))	# False
print(isinstance(dog, Dog))	# True
print(isinstance(b, Animal))	# True
print(isinstance(dog, Animal))	# True
```

**å¤šé‡ç»§æ‰¿**

```python
class Runnable(object):
    def run(self):
        print('Running...')


class Flyable(object):
    def fly(self):
        print('Flying...')


class Dog(Runnable, Flyable):
    pass


d = Dog()
d.fly()
d.run()

'''
Flying...
Running...
'''
```

**20.3 å¤šæ€**

```python
class Animal:

    def kind(self):
        print("i am animal")


class Dog(Animal):

    def kind(self):
        print("i am a dog")


class Cat(Animal):

    def kind(self):
        print("i am a cat")


class Pig(Animal):

    def kind(self):
        print("i am a pig")


# è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªanimalå‚æ•°ï¼Œå¹¶è°ƒç”¨å®ƒçš„kindæ–¹æ³•
def show_kind(animal):
    animal.kind()


d = Dog()
c = Cat()
p = Pig()

show_kind(d)
show_kind(c)
show_kind(p)

'''
i am a dog
i am a cat
i am a pig
'''
```

â­Pythonè¯­è¨€çš„åŠ¨æ€è¯­è¨€ç‰¹æ€§ï¼Œä¼ é€’ç»™å‡½æ•°show_kind()çš„å‚æ•°animalå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œåªè¦å®ƒæœ‰ä¸€ä¸ªkind()æ–¹æ³•å³å¯ã€‚åŠ¨æ€è¯­è¨€è°ƒç”¨å®ä¾‹æ–¹æ³•ä¸æ£€æŸ¥ç±»å‹ï¼Œåªè¦æ–¹æ³•å­˜åœ¨ï¼Œå‚æ•°æ­£ç¡®ï¼Œå°±å¯ä»¥è°ƒç”¨



### 21. Pythonæµ…æ‹·è´å’Œæ·±æ‹·è´

â‘ æµ…æ‹·è´ï¼šæ²¡æœ‰æ‹·è´å­å¯¹è±¡ï¼ŒåŸå§‹æ•°æ®æ”¹å˜ï¼Œå­å¯¹è±¡ä¼šæ”¹å˜

```python
import copy
list1 = [1, 2, [1, 3, 4], 7]
list2 = copy.copy(list1)
print(list1,list2)
list1.append(4)
print(list1,list2)
list1[2].append(6)
print(list1,list2)

'''
[1, 2, [1, 3, 4], 7] [1, 2, [1, 3, 4], 7]
[1, 2, [1, 3, 4], 7, 4] [1, 2, [1, 3, 4], 7]
[1, 2, [1, 3, 4, 6], 7, 4] [1, 2, [1, 3, 4, 6], 7]
'''
```

â‘¡æ·±æ‹·è´ï¼šåŒ…å«å¯¹è±¡é‡Œå­å¯¹è±¡çš„æ‹·è´ï¼ŒåŸå§‹æ•°æ®æ”¹å˜ä¸ä¼šé€ æˆæ·±æ‹·è´é‡Œä»»ä½•å­å…ƒç´ çš„æ”¹å˜

```python
import copy
list1 = [1, 2, [1, 3, 4], 7]
list2 = copy.deepcopy(list1)
print(list1,list2)
list1.append(4)
print(list1,list2)
list1[2].append(6)
print(list1,list2)

'''
[1, 2, [1, 3, 4], 7] [1, 2, [1, 3, 4], 7]
[1, 2, [1, 3, 4], 7, 4] [1, 2, [1, 3, 4], 7]
[1, 2, [1, 3, 4, 6], 7, 4] [1, 2, [1, 3, 4], 7]
'''
```

â‘¢åˆ—è¡¨å’Œå…ƒç»„çš„æ·±æ‹·è´å’Œæµ…æ‹·è´

åˆ—è¡¨å¯å˜ï¼Œå…ƒç»„ä¸å¯å˜

```python
import copy
tuple1 = (1, 2, 3)
tuple2 = copy.copy(tuple1)
tuple3 = copy.deepcopy(tuple1)
print(tuple1 is tuple2)	#True
print(tuple1 is tuple3)	#True
print(tuple2 is tuple3)	#True

list1 = [1, 2, 3]
list2 = copy.copy(list1)
list3 = copy.deepcopy(list1)
print(list1 is list2)	#False
print(list2 is list3)	#False
print(list2 is list3)	#False
```



### 22. æ’åº sortä¸sorted

Python listå†…ç½®sort()æ–¹æ³•ç”¨æ¥æ’åºï¼ŒPythonå†…ç½®å…¨å±€çš„sorted()æ–¹æ³•æ¥å¯¹å¯è¿­ä»£åºåˆ—æ’åºç”Ÿæˆæ–°çš„åºåˆ—ã€‚å¯¹dictçš„æ’åºé»˜è®¤ä¼šæŒ‰ç…§keyå€¼æ’åºï¼Œé€šè¿‡æŒ‡å®škeyå‚æ•°å¯å¯¹valueæ’åº

**å¯¹å­—å…¸çš„valueæ’åº**

```python
dict = {'a': 5, 'c': 2, 'b': 6}
res1 = sorted(dict)
print(res1)	#['a','b','c']
res2 = sorted(dict, key=lambda x: dict[x])
print(res2)	#['c','a','b']
```

